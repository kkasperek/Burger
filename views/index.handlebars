{{!-- Setup the index.handlebars to have the template that Handlebars can render onto. --}}
<h1>Burgers</h1>

<h2>Burger to eat...</h2>
<div id="toEat">
  <ul>
    {{#each burgers}}
    {{#unless devoured}}
    <li>
      <p>Burger: {{this.burger_name}}</p>
      <button class="devourButton" type="submit" data-id="{{id}}" name="devour">Devour</button>
    </li>
    {{/unless}}
    {{/each}}
  </ul>
</div>

<h2>Burgers devoured!</h2>
<div id="devoured"></div>


{{!-- making a post request on the submit button --}}
<h2>Add Burger</h2>
<form id="addBurger" class="button-size">
  <textarea type="text" name="burger"></textarea>
  <button type="submit">Add your burger!</button>
</form>


{{!-- jQuery for devour button --}}
<script type="text/javascript">

  $("#addBurger").on("submit", function (event) {
    // Make sure to preventDefault on a submit event.
    event.preventDefault();

    // [name=plan] will find an element with a "name" attribute equal to the string "plan"
    var newBurger = {
      burger_name: $("#addBurger [name=burger]").val().trim(),
      devoured: false
    };

    // Send the POST request.
    $.ajax("/burgers", {
      type: "POST",
      data: newBurger
    }).then(
      function () {
        console.log("added a new burger");
        // Reload the page to get the updated list
        location.reload();
      }
    );
  });

  $(".devourButton").on("click", function (event) {
    // Make sure to preventDefault on a submit event.
    event.preventDefault();

    // Get the ID by finding an element with a "name" attribute equal to the string "id"
    var id = $("[name=id]").val().trim();

    $(.this).css("background-color", "red");
    var devouredBurgers = {
      burger_name: $("#devouredBurgers [name=burger]").val().trim()
    };

    // Send the PUT request.
    $.ajax("/burgers/" + id, {
      type: "PUT",
      data: devouredBurgers
    }).then(
      function () {
        console.log("updated id ", id);
        // Reload the page to get the updated list
        location.reload();
      }
    );
  });
</script>